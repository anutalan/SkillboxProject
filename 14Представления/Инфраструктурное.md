## 14.4 Инфраструктурное представление 

```mermaid
  graph TD;
  subgraph "Клиентская зона"
        Web[[Клиентское Web приложение]]
        Mobile[[Клиентское мобильное приложение]]
        AdminWeb[[Web приложение поддержки]]
        Платформа_IoT
        Онлайн_площадки_бренда       
  end
  subgraph "Основной ЦОД (Локация1)"
   subgraph "Демилитаризованная зона"
    subgraph "Балансировщик "
        Proxy1[[Proxy]]
        LB11[[LB]]
    end
    subgraph "Сервер Gateway"
      Client_API_Gateways1[[Client API Gateway<br>Store GateWay<br>IoT GateWay<br>Registry]]
    end
    subgraph "Сервер IDP"
      Auth1[[Auth]]   
    end
    subgraph "Сервер Приложения*3"
      Web_BFF1[[Web BFF]]   
    end
    subgraph "Сервер Приложения*3"
      Mobile_BFF1[[Mobile BFF]]   
    end
    subgraph "Сервер Приложения*2"
      AdminWeb_BFF1[[AdminWeb BFF]]   
    end
   end
   subgraph "Внутренняя сеть"
     subgraph "Балансировщик"
       LB12[[LB]]
     end
     subgraph "Сервер Gateway"
       Platform_API_Gateways1[[Client API Gateway<br>Store GateWay<br>IoT GateWay<br>Registry]]
     end
     subgraph "Message Broker "
        Брокер_Kafka1[[Kafka<br>Zookeeper]]        
     end
     subgraph "Сервер Приложения*3 "
        Сервисы1[[Пользователи<br>Тренировки<br>Новости Реклама<br>Устройств-датчиков<br>Онлайн площадки<br>Уведомления<br>Социальная сеть<br>Геймификация]] 
     end
     subgraph "Сервер БД "
        PostgreSQL1[[Postgre SQL<br>Consul]]        
     end
     subgraph "Сервер резервного копирования БД"
        Диски1[[Диски]]
     end
     BackUp1[[BackUp каждого сервера платформы]]
   end
  end
  
  Web -->Proxy1;
  Mobile -->Proxy1;
  AdminWeb -->Proxy1; 
  Proxy1-->Client_API_Gateways1;
  Client_API_Gateways1-->Web_BFF1;
  Client_API_Gateways1-->Mobile_BFF1;
  Client_API_Gateways1-->AdminWeb_BFF1;
  Client_API_Gateways1-->Auth1;
  Client_API_Gateways1-->Platform_API_Gateways1
  Web_BFF1-->Platform_API_Gateways1;
  Mobile_BFF1-->Platform_API_Gateways1;
  AdminWeb_BFF1-->Platform_API_Gateways1;
  Онлайн_площадки_бренда-->Proxy1;
  Платформа_IoT-->Proxy1;
  Platform_API_Gateways1-->Сервисы1;
  Сервисы1-->Брокер_Kafka1;
  Сервисы1-->PostgreSQL1;
  PostgreSQL1-->Диски1;
  Сервисы1-->BackUp1;
  
  
   subgraph "Резервный ЦОД (Локация2)"
   subgraph "Демилитаризованная зона"
    subgraph "Балансировщик "
        Proxy2[[Proxy]]
        LB21[[LB]]
    end
    subgraph "Сервер Gateway"
      Client_API_Gateways2[[Client API Gateway<br>Store GateWay<br>IoT GateWay<br>Registry]]
    end
    subgraph "Сервер IDP"
      Auth2[[Auth]]   
    end
    subgraph "Сервер Приложения*3"
      Web_BFF2[[Web BFF]]   
    end
    subgraph "Сервер Приложения*3"
      Mobile_BFF2[[Mobile BFF]]   
    end
    subgraph "Сервер Приложения*2"
      AdminWeb_BFF2[[AdminWeb BFF]]   
    end
   end
   subgraph "Внутренняя сеть"
    subgraph "Балансировщик "
        LB22[[LB]]
    end
    subgraph "Сервер Gateway"
       Platform_API_Gateways2[[Client API Gateway<br>Store GateWay<br>IoT GateWay<br>Registry]]
     end
     subgraph "Message Broker "
        Брокер_Kafka2[[Kafka<br>Zookeeper]]        
     end
     subgraph "Сервер Приложения*3 "
        Сервисы2[[Пользователи<br>Тренировки<br>Новости Реклама<br>Устройств-датчиков<br>Онлайн площадки<br>Уведомления<br>Социальная сеть<br>Геймификация]]
     end
     subgraph "Сервер БД "
        PostgreSQL2[[Postgre SQL<br>Consul]]
     end
     subgraph "Сервер резервного копирования БД"
        Диски2[[Диски]]
     end
     BackUp2[[BackUp каждого сервера платформы]]
   end
  end
  
  Web -->Proxy2;
  Mobile -->Proxy2;
  AdminWeb -->Proxy2;
 
  Proxy2-->Client_API_Gateways2;
  Client_API_Gateways2-->Web_BFF2;
  Client_API_Gateways2-->Mobile_BFF2;
  Client_API_Gateways2-->AdminWeb_BFF2;
  Client_API_Gateways2-->Auth2;
  Client_API_Gateways2-->Platform_API_Gateways2;
  Web_BFF2-->Platform_API_Gateways2;
  Mobile_BFF2-->Platform_API_Gateways2;
  AdminWeb_BFF2-->Platform_API_Gateways2;
  Онлайн_площадки_бренда-->Client_API_Gateways2;
  Платформа_IoT-->Client_API_Gateways2;
  
  Platform_API_Gateways2-->Сервисы2;    
  Сервисы2-->Брокер_Kafka2;
  Сервисы2-->PostgreSQL2;
  PostgreSQL2-->Диски2;
  Сервисы2-->BackUp2;
  
  LB21---Client_API_Gateways2;
  LB21---Web_BFF2;
  LB21---Mobile_BFF2;
  LB21---AdminWeb_BFF2;
  LB21---Auth2;
  LB22---Platform_API_Gateways2;
  LB22---Сервисы2;
  
  LB11---Client_API_Gateways1;
  LB11---Web_BFF1;
  LB11---Mobile_BFF1;
  LB11---AdminWeb_BFF1;
  LB11---Auth1;
  LB12---Platform_API_Gateways1;
  LB12---Сервисы1;
  
  PostgreSQL1---|Кластер БД|PostgreSQL2;
  Proxy1---Proxy2;
  LB11---LB21;
  LB12---LB22;
 ```
