---
## 11. Список ADR

### 001-ADR: Выбор архитектуры

Альтернативы:

1) Монолит: сложно масштабировать его на разные облака, настраивать и интегрировать с существующими системами бренда, которые находятся в разных облаках; трудно будет занять всех разработчиков, если их много, а компонент по сути один, неделимый; для разработки этот подход не является развитием, он по умолчанию предполагает последующий распил монолита, а значит зря потраченные ресурсы в самом начале; не подходит для распределенных команд и разных облаков.

2) Микросервисная архитектура: гибкость масштабируемости и плюс в независимости команд; можно использовать различные облака, разные технологии по мере необходимости, если разработчики хотят развиваться и пробовать новое - можно отдельные компоненты писать на других языках. Если сроки не горят, то можно спроектировать уже сразу данную архитектуру, чтобы не переписывать платформу 10 раз.

Решение: Микросервисная архитектура

Обоснования: 

- необходимость использования разных облаков - на данный момент 90 % существующих приложений бренда, которыми нужно будет интегрироваться, развернуто в разных облаках разных страх;

- предполагается много интеграций с магазинами бренда, устройствами с датчиками; 

-  наличие независимых доменов позволит распределить независимые домены среди команд;

- уже в наличии распределенные команды с достаточным кол-вом разработчиков; 

- микросервисы поддержат требование к масштабированию отдельных компонент при нагрузке.


### 002-ADR: Развертывание в облаках

Альтернативы:

1) Kubernates: высокая автоматизация развертывания и масштабирования, отказоустойчивость, поддержка облаков, разных провайдеров.

2) Силами администраторов: требуется много ручной работы и сильный мониторинг платформы; платформа всегда в зоне человеческого риска, а следовательно отсутствие надежности и отказоустойчивости; много времени занимает ручное обновление и масштабирование, прибитое гвоздями; очень плохо подходит для распределенных команд.

Решение: Использование Kubernates в распределенных облаках. 

Обоснование: Отказоустойчивость, наличие 90 % сущестсвующих приложений бренда в разных облаках, доступность для пользователя в своем регионе, стране - возможность расширения покрытия.


### 003-ADR: Аутентификация

Альтернативы:

1) JWT: сложность управления централизованного, возможно отсутствие поддержки SSO при переходе из приложения в приложение, сложность реализации и риски неправильной реализации.

2) OATH2 + OIDC: стандартизированный подход, возможность централизованного управления пользователями, поддержка SSO.

Решение: Использование OAuth2 и OIDC и общего Idp (c SSO).

Обоснование: Безопасность итеграцции с существующими приложениями бренда, чтобы переходы между всеми приложениями (данным приложением и магазинами), решениями ui (web\mobile) были бесшовными. 

### 004-ADR: Сервер приложения

Альтернативы:

1) Api сервер: единый для всех клиентов без оптимизации передаваемых данных в случае web и mobile клиентов; для мобильных приложений получаем увеличенный трафик данных, которые не используются приложением, но на их получение затрачивется существенное время.

2) BFF: предоставляет возможность публикаций api под разных клиентов с оптимизацией передаваемых данных - это влечет увеличение производительности и скорости выполенния запросов, можно поддерживать разные бизнес процессы для веба - полные процессы, для  мобильных приложений - облегченные.

Решение: Использование BFF с разделением api для мобильных приложений и web.

Обоснование: Облегчение данных для мобильных клиентов, увеличение скорости обработки запросов, контроль данных. Поддержка реализации разных сценариев использования в web и мобильном приложении.

### 005-ADR: Хранение данных

Альтернативы:

1) Только реляция: трудности с хранением неструктурированных данных, не подходит для хранения изменяющейся структуры данных, поддерживаются транзакции, хранит структурированные данные.

2) Только nosql: не поддерживаются транзакции, не используется для выполнения контроля бизнес логики, хранит неструктурированные данные.

3) Только графовая БД: сложности с транзакциями, не подходит для хранения больших объемов данных, низкая производительность, подходит для хранения связей между сущностями.

4) Одновременное смешанное использование разных БД: можно использовать разные БД под разные нужны платформы.


Решение: Одновременное использование SQL(реляционные) и NoSQL(документоориентированные) баз данных, графовых

Обоснование: Графы удобны для хранения связей социальных сетей, документоориентированные могут содержать разные наборы данных разных форматов, что пригодится для телеметрии точно. Реляционная нужна для контроля основной логики приложения, нужен контроль транзакций.

